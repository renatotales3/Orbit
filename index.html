<!DOCTYPE html>
<html lang="pt-br" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life OS v1.1</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Seu sistema pessoal de produtividade, foco e bem-estar. Pomodoro, tarefas, metas, hábitos e muito mais.">
    <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="background-color" content="#F0F2F5">
    
    <!-- Android Specific Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Life OS">
    <meta name="color-scheme" content="light dark">
    
    <!-- Apple PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Life OS">
    <link rel="apple-touch-icon" href="assets/icon-192.png">
    
    <!-- Microsoft PWA Meta Tags -->
    <meta name="msapplication-TileColor" content="#007AFF">
    <meta name="msapplication-TileImage" content="assets/icon-144.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="assets/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/icon-16.png">
    <link rel="shortcut icon" href="assets/icon-32.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <main class="content">
        <section id="inicio" class="page">
            <h1>Início</h1>
            <div style="background: linear-gradient(135deg, #007AFF, #6C7EFF); color: white; padding: 1rem; border-radius: 1.2rem; margin-bottom: 2rem; text-align: center;">
                <p style="margin: 0; font-weight: 600;">🚀 Life OS v1.1 - Teste de Atualização</p>
                <p style="margin: 0.5rem 0 0 0; font-size: 1.4rem; opacity: 0.9;">Verificando se o APK atualiza automaticamente!</p>
            </div>
            <p>Em breve, seus insights diários estarão aqui.</p>
        </section>

        <section id="foco" class="page">
            <h1>Foco</h1>
            <div class="foco-grid-container">
                <div class="pomodoro-app">
                    <header class="pomodoro-header">
                        <h2>Pomodoro</h2>
                    </header>
                    <div class="pomodoro-timer">
                        <div class="timer-display-container"><h2 id="timer-display">25:00</h2></div>
                        <p id="timer-status">Hora de Focar!</p>
                        <div class="pomodoro-controls">
                            <button id="start-btn" class="soft-button pomodoro-btn" aria-label="Iniciar timer"><i class='bx bx-play'></i></button>
                            <button id="pause-btn" class="soft-button pomodoro-btn" aria-label="Pausar timer"><i class='bx bx-pause'></i></button>
                            <button id="reset-btn" class="soft-button pomodoro-btn" aria-label="Reiniciar timer"><i class='bx bx-reset'></i></button>
                        </div>
                    </div>
                </div>
                <div class="todo-app">
                    <header class="todo-header">
                        <h2>Tarefas do Dia</h2>
                        <button id="clear-completed-tasks-btn" class="soft-button icon-btn md hidden" title="Limpar Concluídas">
                            <i class='bx bxs-eraser'></i>
                        </button>
                    </header>
                    <div class="todo-body">
                        <div class="add-task-container">
                            <input type="text" id="task-input" class="soft-input" placeholder="Adicionar tarefa...">
                            <div class="priority-selector-wrapper">
                                <button id="task-priority-btn" class="soft-button priority-btn" aria-label="Selecionar Prioridade">
                                    <i class='bx bxs-circle priority-indicator-btn priority-3'></i>
                                </button>
                                <div id="priority-picker" class="priority-picker hidden"></div>
                            </div>
                            <button id="add-task-btn" class="soft-button add-btn" aria-label="Adicionar Tarefa"><i class='bx bx-plus'></i></button>
                        </div>
                        <ul id="task-list"></ul>
                    </div>
                </div>
                <div class="goals-app">
                    <header class="goals-header">
                        <h2>Minhas Metas</h2>
                        <button id="add-goal-modal-btn" class="soft-button"><i class='bx bx-plus'></i> Nova Meta</button>
                    </header>
                    <ul id="goals-list"></ul>
                </div>
                <div class="focus-mits-card">
                    <header class="todo-header">
                        <h2>MITs do Dia</h2>
                    </header>
                    <div class="todo-body">
                        <div class="add-task-container">
                            <input type="text" id="mit-input" class="soft-input" placeholder="Adicionar MIT...">
                            <button id="add-mit-btn" class="soft-button add-btn" aria-label="Adicionar MIT"><i class='bx bx-plus'></i></button>
                        </div>
                        <ul id="mits-list"></ul>
                        <p style="font-size:1.2rem; opacity:0.7; margin-top:0.5rem;">Máx. 3 itens</p>
                        <div style="margin-top:1rem; display:flex; gap:1rem;">
                            <button id="carryover-mits-btn" class="soft-button gray">Levar para amanhã</button>
                            <button id="clear-mits-btn" class="soft-button danger">Limpar MITs</button>
                        </div>
                    </div>
                </div>
                <div class="focus-stats-card">
                    <header class="todo-header">
                        <h2>Estatísticas de Foco</h2>
                    </header>
                    <div class="todo-body">
                        <div class="stats-grid">
                            <div class="stat-item"><span>Hoje (min)</span><strong id="focus-stats-today-minutes">0</strong></div>
                            <div class="stat-item"><span>Sessões</span><strong id="focus-stats-today-sessions">0</strong></div>
                            <div class="stat-item"><span>Semana (min)</span><strong id="focus-stats-week-minutes">0</strong></div>
                        </div>
                    </div>
                </div>

                <div class="productivity-chart-card">
                    <header class="todo-header">
                        <h2>Produtividade Semanal</h2>
                    </header>
                    <div class="todo-body">
                        <div class="chart-container">
                            <div class="chart-bars" id="productivity-chart">
                                <!-- Gráfico será gerado dinamicamente -->
                            </div>
                            <div class="chart-labels" id="productivity-chart-labels">
                                <!-- Labels gerados dinamicamente -->
                            </div>
                        </div>
                        <div class="chart-legend">
                            <div class="legend-item">
                                <div class="legend-color tasks-color"></div>
                                <span>Tarefas Concluídas</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color focus-color"></div>
                                <span>Minutos de Foco</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="review-card">
                    <header class="todo-header">
                        <h2>Review do Dia</h2>
                    </header>
                    <div class="todo-body">
                        <div id="review-form-view">
                            <form id="review-form" style="display:flex; flex-direction:column; gap:1rem;">
                                <textarea id="review-good" class="soft-textarea" placeholder="Foi bem?"></textarea>
                                <textarea id="review-delay" class="soft-textarea" placeholder="Adiar?"></textarea>
                                <textarea id="review-learn" class="soft-textarea" placeholder="Aprendizado?"></textarea>
                                <button type="submit" class="soft-button">Salvar Review</button>
                            </form>
                        </div>
                        <div id="review-completed-view" style="display:none;">
                            <p><strong>Foi bem:</strong></p>
                            <p id="review-good-view"></p>
                            <p style="margin-top:1rem;"><strong>Adiar:</strong></p>
                            <p id="review-delay-view"></p>
                            <p style="margin-top:1rem;"><strong>Aprendizado:</strong></p>
                            <p id="review-learn-view"></p>
                            <button id="edit-review-btn" class="soft-button gray" style="margin-top:1rem;"><i class='bx bxs-pencil'></i> Editar</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        

        <section id="bem-estar" class="page">
            <h1>Bem-estar</h1>

            <div class="water-tracker-card">
                <header class="water-header">
                    <div class="metric-header">
                        <i class='bx bxs-droplet'></i>
                        <h4>Hidratação</h4>
                    </div>
                    <button id="water-history-btn" class="soft-button icon-btn md" aria-label="Ver Histórico de Hidratação">
                        <i class='bx bx-history'></i>
                    </button>
                </header>
                <div class="water-body">
                    <button id="decrease-water-btn" class="soft-button metric-control-btn"><i class='bx bx-minus'></i></button>
                    <div class="water-display">
                        <span id="water-count">0</span>
                        <span id="water-goal-text">/ 8 copos</span>
                    </div>
                    <button id="increase-water-btn" class="soft-button metric-control-btn"><i class='bx bx-plus'></i></button>
                </div>
                <div class="water-footer">
                    <progress id="water-progress" value="0" max="100"></progress>
                    <p id="water-feedback"></p>
                </div>
            </div>

            <div class="water-tracker-card">
                <header class="water-header">
                    <div class="metric-header">
                        <i class='bx bx-calendar-week'></i>
                        <h4>Resumo da Semana</h4>
                    </div>
                    <button id="share-weekly-summary-btn" class="soft-button icon-btn md" aria-label="Compartilhar Resumo">
                        <i class='bx bx-share-alt'></i>
                    </button>
                </header>
                <div class="water-footer" style="padding:1.5rem;">
                    <ul id="weekly-summary-list" style="list-style:none; display:flex; flex-direction:column; gap:0.8rem;"></ul>
                </div>
            </div>

            <div class="sleep-tracker-card">
                <header class="sleep-header">
                    <div class="metric-header">
                        <h4>Sono</h4>
                    </div>
                    <button id="sleep-history-btn" class="soft-button icon-btn md" aria-label="Ver Histórico de Sono">
                        <i class='bx bx-history'></i>
                    </button>
                </header>
                <div class="sleep-week-bars" id="sleep-week-bars"></div>
                <div class="sleep-body-container">
                    <div id="sleep-form-view" class="metric-body sleep-body">
                        <form id="sleep-form">
                            <div class="sleep-inputs">
                                <div>
                                    <label for="bed-time">Dormi às</label>
                                    <input type="time" id="bed-time" class="soft-input">
                                </div>
                                <div>
                                    <label for="wake-time">Acordei às</label>
                                    <input type="time" id="wake-time" class="soft-input">
                                </div>
                            </div>
                            <button type="submit" id="save-sleep-btn" class="soft-button">Salvar Sono</button>
                        </form>
                    </div>
                    <div id="sleep-completed-view" class="metric-body sleep-body completed">
                        <div class="sleep-total-display">
                            <p>Total de Sono</p>
                            <p id="sleep-total"></p>
                        </div>
                        <p id="sleep-feedback"></p>
                        <button id="edit-sleep-btn" class="soft-button gray"><i class='bx bxs-pencil'></i> Editar</button>
                    </div>
                </div>
            </div>

            <div class="mood-tracker">
                <h3>Como você está se sentindo hoje?</h3>
                <div id="mood-options" class="mood-options"></div>
            </div>

            <div id="daily-journal" class="daily-journal">
                <header class="journal-header">
                    <h4>Reflexão do Dia</h4>
                    <button id="show-journal-history-btn" class="soft-button icon-btn md" aria-label="Ver Histórico de Reflexões">
                        <i class='bx bx-history'></i>
                    </button>
                </header>
                <div class="journal-body">
                    <div class="journal-form">
                        <p id="journal-question" class="journal-question-text"></p>
                        <form id="journal-form">
                            <textarea id="journal-input" class="soft-textarea" placeholder="Sua reflexão aqui..."></textarea>
                            <button type="submit" class="soft-button">Salvar Reflexão</button>
                        </form>
                    </div>
                    <div class="journal-completed-view">
                        <p id="journal-question-completed" class="journal-question-text"></p>
                        <p id="journal-answer"></p>
                        <span>Ótimo, te vejo amanhã!</span>
                    </div>
                </div>
            </div>

            <div class="habit-tracker">
                <header class="habits-header">
                    <h2>Meus Hábitos</h2>
                    <button id="add-habit-modal-btn" class="soft-button"><i class='bx bx-plus'></i> Novo Hábito</button>
                </header>
                <ul id="habits-list"></ul>
            </div>

        </section>

        <section id="financas" class="page">
            
            <!-- Resumo Financeiro -->
            <div class="finance-summary-card">
                <header class="finance-summary-header">
                    <h2 id="finance-summary-title">Resumo do Mês</h2>
                    <div class="finance-summary-actions">
                        <button id="finance-period-filter-btn" class="soft-button icon-btn" title="Filtrar Transações">
                            <i class='bx bx-filter-alt'></i>
                        </button>
                    </div>
                </header>
                <div class="finance-summary-grid">
                    <div class="finance-summary-item income">
                        <span class="finance-label">Entradas</span>
                        <span id="finance-total-income" class="finance-value">R$ 0,00</span>
                    </div>
                    <div class="finance-summary-item expense">
                        <span class="finance-label">Saídas</span>
                        <span id="finance-total-expense" class="finance-value">R$ 0,00</span>
                    </div>
                    <div class="finance-summary-item balance">
                        <span class="finance-label">Saldo</span>
                        <span id="finance-balance" class="finance-value">R$ 0,00</span>
                    </div>
                </div>
                <div class="finance-progress-container">
                    <div class="finance-progress-bar">
                        <div id="finance-progress-fill" class="finance-progress-fill" style="width: 0%"></div>
                    </div>
                    <span id="finance-progress-text" class="finance-progress-text">0% do orçamento usado</span>
                </div>
            </div>

            <!-- Ação de Adicionar -->
            <div class="finance-add-section">
                <button id="add-income-btn" class="soft-button finance-income-btn">
                    <i class='bx bx-plus-circle'></i> Adicionar Receita
                </button>
                <button id="add-expense-btn" class="soft-button finance-expense-btn">
                    <i class='bx bx-minus-circle'></i> Adicionar Despesa
                </button>
            </div>

            <!-- Lista de Transações -->
            <div class="finance-transactions-card">
                <header class="finance-transactions-header">
                    <h3>Transações</h3>
                    <button id="finance-transactions-filter-btn" class="soft-button icon-btn" title="Filtrar Transações">
                        <i class='bx bx-filter-alt'></i>
                    </button>
                </header>
                <div class="finance-transactions-body">
                    <ul id="finance-transactions-list" class="finance-transactions-list">
                        <!-- Transações serão inseridas aqui -->
                    </ul>
                </div>
            </div>
        </section>

        <section id="ajustes" class="page">
            <h1>Ajustes</h1>
            <div class="settings-card">
                <header class="settings-card-header">
                    <i class='bx bx-palette'></i>
                    <h2>Aparência</h2>
                </header>
                <div class="settings-card-body">
                    <div class="setting-row">
                        <label for="theme-toggle">Tema Escuro</label>
                        <button id="theme-toggle" class="toggle-button"><div class="toggle-circle"></div></button>
                    </div>
                    <div class="setting-divider"></div>
                    <div class="setting-row column">
                        <label>Cor de Destaque</label>
                        <div id="light-theme-palette" class="color-palette"></div>
                        <div id="dark-theme-palette" class="color-palette"></div>
                    </div>
                </div>
            </div>
            <div class="settings-card">
                 <header class="settings-card-header">
                    <i class='bx bx-timer'></i>
                    <h2>Pomodoro</h2>
                </header>
                <div class="settings-card-body">
                    <div class="setting-row">
                        <label for="focus-time">Foco (minutos)</label>
                        <input type="number" id="focus-time" class="soft-input" min="1">
                    </div>
                    <div class="setting-row">
                        <label for="short-break-time">Pausa Curta (minutos)</label>
                        <input type="number" id="short-break-time" class="soft-input" min="1">
                    </div>
                    <div class="setting-row">
                        <label for="long-break-time">Pausa Longa (minutos)</label>
                        <input type="number" id="long-break-time" class="soft-input" min="1">
                    </div>
                </div>
            </div>
            <div class="settings-card">
                <header class="settings-card-header">
                   <i class='bx bx-slider-alt'></i>
                   <h2>Hidratação</h2>
               </header>
               <div class="settings-card-body">
                   <div class="setting-row">
                        <label for="water-goal">Meta de Água (em unidades)</label>
                        <input type="number" id="water-goal" class="soft-input" min="1">
                    </div>
                    <div class="setting-row">
                        <label for="water-cup-ml">Unidade (ml por copo)</label>
                        <input type="number" id="water-cup-ml" class="soft-input" min="50" step="10">
                    </div>
                 </div>
            </div>
            <div class="settings-card">
                <header class="settings-card-header">
                    <i class='bx bx-data'></i>
                    <h2>Dados</h2>
                </header>
                <div class="settings-card-body">
                    <div class="setting-row">
                        <label>Limpar histórico antigo (mais de 180 dias)</label>
                        <button id="purge-old-data-btn" class="soft-button gray">Limpar</button>
                    </div>
                    <div class="setting-row">
                        <label>Resetar todos os dados (irreversível)</label>
                        <button id="reset-all-data-btn" class="soft-button danger">Resetar</button>
                    </div>
                </div>
            </div>
            <div class="settings-card">
                <header class="settings-card-header">
                    <i class='bx bx-help-circle'></i>
                    <h2>Tutorial</h2>
                </header>
                <div class="settings-card-body">
                    <div class="setting-row">
                        <label>Como usar o Life OS</label>
                        <button id="open-tutorial-btn" class="soft-button">Abrir Tutorial</button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Modals -->
    <div id="goal-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <h3 id="modal-title">Criar Nova Meta</h3>
            <form id="goal-form">
                <input type="text" id="goal-title-input" class="soft-input" placeholder="Título da Meta" required>
                <textarea id="goal-motivation-input" class="soft-textarea" placeholder="Minha motivação..."></textarea>
                <label>Categorias:</label>
                <div id="goal-category-container" class="category-container"></div>
                <label for="goal-date-input">Data Alvo:</label>
                <input type="date" id="goal-date-input" class="soft-input">
                <div class="modal-actions"><button type="button" id="cancel-goal-btn" class="soft-button gray">Cancelar</button><button type="submit" class="soft-button">Salvar</button></div>
            </form>
        </div>
    </div>

    <div id="habit-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <h3 id="habit-modal-title">Novo Hábito</h3>
            <form id="habit-form">
                <input type="text" id="habit-name-input" class="soft-input" placeholder="Nome do Hábito" required>
                <label>Ícone:</label>
                <div id="habit-icon-picker" class="picker-container"></div>
                <label>Cor:</label>
                <div id="habit-color-picker" class="picker-container"></div>
                <div class="modal-actions">
                    <button type="button" id="delete-habit-btn" class="soft-button danger hidden">Excluir</button>
                    <div><button type="button" id="cancel-habit-btn" class="soft-button gray">Cancelar</button><button type="submit" class="soft-button">Salvar</button></div>
                </div>
            </form>
        </div>
    </div>

    <div id="confirmation-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <h3>Tem certeza?</h3>
            <p>Esta ação não pode ser desfeita.</p>
            <div class="modal-actions">
                <button type="button" id="confirmation-cancel-btn" class="soft-button gray">Cancelar</button>
                <button type="button" id="confirmation-confirm-btn" class="soft-button danger">Confirmar Exclusão</button>
            </div>
        </div>
    </div>

    <div id="journal-history-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <header class="modal-header">
                <h3>Histórico de Reflexões</h3>
                <button id="close-journal-history-btn-x" class="soft-button icon-btn md close-btn"><i class='bx bx-x'></i></button>
            </header>
            <ul id="journal-history-list"></ul>
            <div class="modal-actions">
                <button type="button" id="close-journal-history-btn" class="soft-button gray">Fechar</button>
            </div>
        </div>
    </div>

    <div id="metrics-history-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <header class="modal-header">
                <h3 id="metrics-history-title">Histórico</h3>
                <button id="close-metrics-history-btn-x" class="soft-button icon-btn md close-btn"><i class='bx bx-x'></i></button>
            </header>
            <ul id="metrics-history-list"></ul>
            <div class="modal-actions">
                <button type="button" id="close-metrics-history-btn" class="soft-button gray">Fechar</button>
            </div>
        </div>
    </div>

    <div id="priority-modal-for-subtask" class="modal-backdrop hidden">
        <div class="modal-content small">
            <h3 class="modal-title-center">Definir Prioridade</h3>
            <div id="subtask-priority-picker" class="priority-picker-modal"></div>
        </div>
    </div>

    <div id="sleep-quality-modal" class="modal-backdrop hidden">
        <div class="modal-content small">
            <h3 class="modal-title-center">Qualidade do Sono</h3>
            <div style="display:flex; flex-direction:column; gap:1rem; margin-top:1rem;">
                <label for="sleep-quality-input">De 1 (ruim) a 5 (excelente)</label>
                <input type="number" id="sleep-quality-input" class="soft-input" min="1" max="5" value="4">
                <div class="modal-actions">
                    <button type="button" id="sleep-quality-cancel" class="soft-button gray">Cancelar</button>
                    <button type="button" id="sleep-quality-confirm" class="soft-button">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="app-notice-modal" class="modal-backdrop hidden">
        <div class="modal-content small">
            <h3 class="modal-title-center" id="app-notice-title">Aviso</h3>
            <p id="app-notice-text" style="margin-top:1rem;"></p>
            <div class="modal-actions" id="app-notice-actions">
                <button type="button" id="app-notice-cancel" class="soft-button hidden">Cancelar</button>
                <button type="button" id="app-notice-ok" class="soft-button">OK</button>
            </div>
        </div>
    </div>

    <div id="tutorial-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <header class="modal-header">
                <h3>Como usar o Life OS</h3>
                <button id="close-tutorial-btn-x" class="soft-button icon-btn md close-btn"><i class='bx bx-x'></i></button>
            </header>
            <div id="tutorial-content" style="max-height:60vh; overflow:auto; display:flex; flex-direction:column; gap:1rem;"></div>
            <div class="modal-actions">
                <button type="button" id="close-tutorial-btn" class="soft-button gray">Fechar</button>
            </div>
        </div>
    </div>

    <div id="transaction-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <header class="modal-header">
                <h3 id="transaction-modal-title">Nova Transação</h3>
                <button id="close-transaction-btn" class="soft-button icon-btn md close-btn"><i class='bx bx-x'></i></button>
            </header>
            <form id="transaction-form">
                <div class="finance-form-field">
                    <label for="transaction-description">Descrição (opcional):</label>
                    <input type="text" id="transaction-description" class="soft-input" placeholder="Ex: Almoço executivo">
                </div>

                <div class="finance-amount-section">
                    <label for="transaction-amount">Valor:</label>
                    <div class="finance-amount-input-container">
                        <span class="finance-currency">R$</span>
                        <input type="number" id="transaction-amount" class="finance-amount-input" placeholder="0,00" step="0.01" min="0">
                    </div>
                </div>

                <div class="finance-quick-amounts" id="finance-quick-amounts">
                    <button type="button" class="category-btn" data-amount="10">+10</button>
                    <button type="button" class="category-btn" data-amount="25">+25</button>
                    <button type="button" class="category-btn" data-amount="50">+50</button>
                    <button type="button" class="category-btn" data-amount="100">+100</button>
                    <button type="button" class="category-btn" data-amount="200">+200</button>
                    <button type="button" class="category-btn" data-amount="500">+500</button>
                </div>

                <div class="finance-category-section">
                    <label>Categoria:</label>
                    <div class="category-selector-wrapper">
                        <button id="transaction-category-btn" class="soft-button category-selector-btn" type="button" aria-label="Selecionar Categoria">
                            <i id="transaction-category-icon" class='bx bx-category'></i>
                            <span id="transaction-category-text">Selecionar categoria</span>
                            <i class='bx bx-chevron-down'></i>
                        </button>
                        <div id="transaction-category-picker" class="category-picker hidden"></div>
                    </div>
                </div>

                <div class="finance-form-row">
                    <div class="finance-form-field">
                        <label for="transaction-date">Data:</label>
                        <input type="date" id="transaction-date" class="soft-input">
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" id="delete-transaction-btn" class="soft-button danger hidden">Excluir</button>
                    <div class="finance-action-buttons">
                        <button type="button" id="cancel-transaction-btn" class="soft-button gray">Cancelar</button>
                        <button type="submit" class="soft-button finance-save-btn">Salvar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>



    <div id="finance-category-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <header class="modal-header">
                <h3>Filtrar por Categoria</h3>
                <button id="close-category-modal-btn" class="soft-button icon-btn md close-btn"><i class='bx bx-x'></i></button>
            </header>
            <div class="finance-category-filter-grid" id="finance-category-filter-grid">
                <!-- Categorias de filtro serão inseridas aqui -->
            </div>
            <div class="modal-actions">
                <button type="button" id="clear-category-filter-btn" class="soft-button gray">Limpar Filtro</button>
                <button type="button" id="close-category-modal-footer-btn" class="soft-button">Fechar</button>
            </div>
        </div>
    </div>

    <div id="transactions-filter-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <header class="modal-header">
                <h3>Filtrar Transações</h3>
                <button id="close-transactions-filter-btn" class="soft-button icon-btn md close-btn"><i class='bx bx-x'></i></button>
            </header>
            
            <div class="finance-filter-tabs">
                <button class="filter-tab-btn active" data-tab="period">Por Período</button>
                <button class="filter-tab-btn" data-tab="category">Por Categoria</button>
            </div>
            
            <div class="filter-tab-content">
                <div class="filter-tab-panel active" id="transactions-period-panel">
                    <div class="finance-period-section">
                        <h4>Períodos Rápidos</h4>
                        <div class="finance-period-chips" id="transactions-period-chips">
                            <button class="category-btn active" data-period="month">Este Mês</button>
                            <button class="category-btn" data-period="week">Esta Semana</button>
                            <button class="category-btn" data-period="today">Hoje</button>
                            <button class="category-btn" data-period="all">Todos</button>
                        </div>
                    </div>
                    
                    <div class="finance-period-divider"></div>
                    
                    <div class="finance-period-section">
                        <h4>Período Personalizado</h4>
                        <div class="finance-custom-period">
                            <div class="finance-date-row">
                                <div class="finance-date-field">
                                    <label for="transactions-start-date">Data Inicial:</label>
                                    <input type="date" id="transactions-start-date" class="soft-input">
                                </div>
                                <div class="finance-date-field">
                                    <label for="transactions-end-date">Data Final:</label>
                                    <input type="date" id="transactions-end-date" class="soft-input">
                                </div>
                            </div>
                            <button type="button" id="apply-transactions-period-btn" class="soft-button">Aplicar Período</button>
                        </div>
                    </div>
                </div>
                
                <div class="filter-tab-panel" id="transactions-category-panel">
                    <div class="finance-category-filter-grid" id="transactions-category-filter-grid">
                        <!-- Categorias de filtro serão inseridas aqui -->
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" id="clear-transactions-filter-btn" class="soft-button gray">Limpar Filtros</button>
                <button type="button" id="close-transactions-filter-footer-btn" class="soft-button">Fechar</button>
            </div>
        </div>
    </div>


    <footer class="bottom-nav">
        <nav>
            <button class="nav-button" data-target="inicio"><i class='bx bx-home-alt'></i><span>Início</span></button>
            <button class="nav-button" data-target="foco"><i class='bx bx-target-lock'></i><span>Foco</span></button>
            <button class="nav-button" data-target="bem-estar"><i class='bx bx-heart'></i><span>Bem-estar</span></button>
            <button class="nav-button" data-target="financas"><i class='bx bx-wallet'></i><span>Finanças</span></button>
            <button class="nav-button" data-target="ajustes"><i class='bx bx-cog'></i><span>Ajustes</span></button>
        </nav>
    </footer>

    <script src="script.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Registrar Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('✅ Service Worker registrado:', registration.scope);
                    
                    // Detectar atualizações
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // Nova versão disponível
                                showUpdateAvailable(registration);
                            }
                        });
                    });
                } catch (error) {
                    console.log('❌ Falha ao registrar Service Worker:', error);
                }
            });
        }
        
        // Mostrar notificação de atualização disponível
        function showUpdateAvailable(registration) {
            // Usando o sistema de notificação existente do Life OS
            if (window.Utils && window.Utils.showNotice) {
                const updateApp = () => {
                    registration.waiting.postMessage({ type: 'SKIP_WAITING' });
                    window.location.reload();
                };
                
                // Criar botão de atualização customizado
                const modal = document.getElementById('app-notice-modal');
                const textEl = document.getElementById('app-notice-text');
                const okBtn = document.getElementById('app-notice-ok');
                
                if (modal && textEl && okBtn) {
                    document.getElementById('app-notice-title').textContent = '🚀 Atualização Disponível';
                    textEl.innerHTML = 'Uma nova versão do Life OS está disponível!<br><br>Clique em "Atualizar" para obter as melhorias mais recentes.';
                    okBtn.textContent = 'Atualizar Agora';
                    okBtn.onclick = updateApp;
                    modal.classList.remove('hidden');
                }
            }
        }
        
        // Detectar instalação PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallButton();
        });
        
        // Mostrar botão de instalação (será implementado depois)
        function showInstallButton() {
            console.log('💡 PWA pode ser instalado');
            // TODO: Adicionar botão de instalação na UI
        }
        
        // Detectar quando PWA foi instalado
        window.addEventListener('appinstalled', () => {
            console.log('🎉 Life OS foi instalado como PWA!');
            deferredPrompt = null;
        });
        
        // Performance: Preload de recursos críticos
        if ('requestIdleCallback' in window) {
            requestIdleCallback(() => {
                // Preload de ícones importantes quando o browser estiver idle
                const criticalIcons = [
                    'assets/icon-192.png',
                    'assets/icon-512.png'
                ];
                
                criticalIcons.forEach(src => {
                    const link = document.createElement('link');
                    link.rel = 'preload';
                    link.as = 'image';
                    link.href = src;
                    document.head.appendChild(link);
                });
            });
        }
    </script>
</body>
</html>